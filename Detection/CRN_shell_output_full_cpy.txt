(CRN) root@cc9d46b9c969:/home/CRN# python exps/det/CRN_r50_256x704_128x128_4key.py --ckpt_path checkpoint/CRN_r50_256x704_128x128_4key.pth -e -b 4 --gpus 1
Global seed set to 0
2024-03-07 19:14:45,870 - mmcv - INFO - load model from: torchvision://resnet50
2024-03-07 19:14:45,871 - mmcv - INFO - load checkpoint from torchvision path: torchvision://resnet50
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 97.8M/97.8M [00:01<00:00, 55.3MB/s]
2024-03-07 19:14:47,883 - mmcv - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

2024-03-07 19:14:48,156 - mmcv - INFO - load model from: torchvision://resnet50
2024-03-07 19:14:48,156 - mmcv - INFO - load checkpoint from torchvision path: torchvision://resnet50
2024-03-07 19:14:48,207 - mmcv - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

Using 16bit native Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.model_summary.ModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Global seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

Restoring states from the checkpoint path at checkpoint/CRN_r50_256x704_128x128_4key.pth
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from checkpoint at checkpoint/CRN_r50_256x704_128x128_4key.pth
/opt/conda/envs/CRN/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:330: PossibleUserWarning: Using `DistributedSampler` with the dataloaders. During `trainer.test()`, it is recommended to use `Trainer(devices=1)` to ensure each sample/batch gets evaluated exactly once. Otherwise, multi-device settings use `DistributedSampler` that replicates some samples to make sure all devices have same batch size in case of uneven inputs.
  rank_zero_warn(
Testing DataLoader 0:   0%|                                                                                                                                                         | 0/41 [00:02<?, ?it/s]/home/CRN/mmdetection3d/mmdet3d/core/bbox/coders/centerpoint_bbox_coders.py:201: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.post_center_range = torch.tensor(
/home/CRN/mmdetection3d/mmdet3d/core/bbox/coders/centerpoint_bbox_coders.py:201: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.post_center_range = torch.tensor(
Testing DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 41/41 [00:57<00:00,  1.40s/it]
Formating bboxes of img_bbox
Start to convert detection format...
[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 162/162, 56.1 task/s, elapsed: 3s, ETA:     0s
Results writes to ./outputs/det/CRN_r50_256x704_128x128_4key/results_nusc.json
Evaluating bboxes of img_bbox

                                                                                                                                                                                                          mAP: 0.5386                                                                                                                                                                                                 
mATE: 0.6280
mASE: 0.3514
mAOE: 0.4309
mAVE: 0.4409
mAAE: 0.3240
NDS: 0.5518
Eval time: 2.4s

Per-class results:
Object Class	AP	ATE	ASE	AOE	AVE	AAE
car	0.726	0.307	0.172	0.170	0.256	0.125
truck	0.412	0.475	0.295	0.117	0.306	0.113
bus	0.605	0.547	0.176	0.096	0.831	0.098
trailer	0.411	1.790	0.312	0.159	0.000	1.000
construction_vehicle	0.000	1.000	1.000	1.000	1.000	1.000
pedestrian	0.602	0.527	0.271	0.408	0.333	0.141
motorcycle	0.561	0.577	0.257	1.212	0.105	0.092
bicycle	0.502	0.451	0.282	0.630	0.697	0.023
traffic_cone	0.725	0.239	0.456	nan	nan	nan
barrier	0.841	0.368	0.294	0.086	nan	nan
Testing DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 41/41 [01:07<00:00,  1.65s/it]
TEST Profiler Report

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                                                    	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                                                     	|  -              	|  634            	|  70.528         	|  100 %          	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_test_evaluation                                                                                                                                                                                       	|  67.65          	|  1              	|  67.65          	|  95.92          	|
|  [Strategy]DDPStrategy.test_step                                                                                                                                                                           	|  1.2829         	|  41             	|  52.599         	|  74.579         	|
|  [LightningModule]CRNLightningModel.test_epoch_end                                                                                                                                                         	|  10.127         	|  1              	|  10.127         	|  14.359         	|
|  [Strategy]DDPStrategy.batch_to_device                                                                                                                                                                     	|  0.033115       	|  41             	|  1.3577         	|  1.9251         	|
|  [LightningModule]CRNLightningModel.test_dataloader                                                                                                                                                        	|  0.11507        	|  1              	|  0.11507        	|  0.16315        	|
|  [Callback]TQDMProgressBar.on_test_batch_end                                                                                                                                                               	|  0.00020991     	|  41             	|  0.0086064      	|  0.012203       	|
|  [LightningModule]CRNLightningModel.on_test_model_train                                                                                                                                                    	|  0.0015059      	|  1              	|  0.0015059      	|  0.0021352      	|
|  [LightningModule]CRNLightningModel.on_test_model_eval                                                                                                                                                     	|  0.0012575      	|  1              	|  0.0012575      	|  0.001783       	|
|  [Callback]TQDMProgressBar.on_test_batch_start                                                                                                                                                             	|  1.1948e-05     	|  41             	|  0.00048988     	|  0.00069459     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                              	|  0.00028701     	|  1              	|  0.00028701     	|  0.00040694     	|
|  [Callback]TQDMProgressBar.on_test_end                                                                                                                                                                     	|  0.00025625     	|  1              	|  0.00025625     	|  0.00036333     	|
|  [Callback]GradientAccumulationScheduler.on_test_batch_end                                                                                                                                                 	|  5.6591e-06     	|  41             	|  0.00023202     	|  0.00032898     	|
|  [Callback]ModelSummary.on_test_batch_start                                                                                                                                                                	|  4.7434e-06     	|  41             	|  0.00019448     	|  0.00027575     	|
|  [Callback]TQDMProgressBar.on_test_start                                                                                                                                                                   	|  0.00011801     	|  1              	|  0.00011801     	|  0.00016732     	|
|  [Callback]ModelSummary.on_test_batch_end                                                                                                                                                                  	|  2.3253e-06     	|  41             	|  9.5339e-05     	|  0.00013518     	|
|  [Callback]GradientAccumulationScheduler.on_test_batch_start                                                                                                                                               	|  1.827e-06      	|  41             	|  7.4905e-05     	|  0.00010621     	|
|  [LightningModule]CRNLightningModel.test_step_end                                                                                                                                                          	|  1.7076e-06     	|  41             	|  7.001e-05      	|  9.9265e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_test_batch_start                	|  1.5711e-06     	|  41             	|  6.4416e-05     	|  9.1334e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_test_batch_end                  	|  1.5574e-06     	|  41             	|  6.3855e-05     	|  9.0538e-05     	|
|  [LightningModule]CRNLightningModel.on_test_batch_start                                                                                                                                                    	|  1.2558e-06     	|  41             	|  5.1488e-05     	|  7.3004e-05     	|
|  [LightningModule]CRNLightningModel.on_test_batch_end                                                                                                                                                      	|  1.1009e-06     	|  41             	|  4.5135e-05     	|  6.3996e-05     	|
|  [Strategy]DDPStrategy.test_step_end                                                                                                                                                                       	|  9.5388e-07     	|  41             	|  3.9109e-05     	|  5.5452e-05     	|
|  [Callback]ModelSummary.on_test_epoch_end                                                                                                                                                                  	|  1.0148e-05     	|  1              	|  1.0148e-05     	|  1.4389e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                                                           	|  9.213e-06      	|  1              	|  9.213e-06      	|  1.3063e-05     	|
|  [Callback]ModelSummary.setup                                                                                                                                                                              	|  5.39e-06       	|  1              	|  5.39e-06       	|  7.6423e-06     	|
|  [Callback]GradientAccumulationScheduler.on_test_end                                                                                                                                                       	|  4.767e-06      	|  1              	|  4.767e-06      	|  6.759e-06      	|
|  [Callback]ModelSummary.teardown                                                                                                                                                                           	|  4.045e-06      	|  1              	|  4.045e-06      	|  5.7353e-06     	|
|  [LightningModule]CRNLightningModel.on_load_checkpoint                                                                                                                                                     	|  3.747e-06      	|  1              	|  3.747e-06      	|  5.3128e-06     	|
|  [LightningModule]CRNLightningModel.on_test_epoch_end                                                                                                                                                      	|  3.341e-06      	|  1              	|  3.341e-06      	|  4.7371e-06     	|
|  [LightningModule]CRNLightningModel.configure_callbacks                                                                                                                                                    	|  3.302e-06      	|  1              	|  3.302e-06      	|  4.6818e-06     	|
|  [LightningModule]CRNLightningModel.configure_sharded_model                                                                                                                                                	|  2.716e-06      	|  1              	|  2.716e-06      	|  3.851e-06      	|
|  [Callback]ModelSummary.on_configure_sharded_model                                                                                                                                                         	|  2.615e-06      	|  1              	|  2.615e-06      	|  3.7077e-06     	|
|  [Callback]ModelSummary.on_test_start                                                                                                                                                                      	|  2.482e-06      	|  1              	|  2.482e-06      	|  3.5192e-06     	|
|  [Callback]GradientAccumulationScheduler.on_test_start                                                                                                                                                     	|  2.297e-06      	|  1              	|  2.297e-06      	|  3.2569e-06     	|
|  [LightningModule]CRNLightningModel.on_test_dataloader                                                                                                                                                     	|  2.191e-06      	|  1              	|  2.191e-06      	|  3.1066e-06     	|
|  [LightningModule]CRNLightningModel.setup                                                                                                                                                                  	|  2.16e-06       	|  1              	|  2.16e-06       	|  3.0626e-06     	|
|  [Callback]ModelSummary.on_before_accelerator_backend_setup                                                                                                                                                	|  1.953e-06      	|  1              	|  1.953e-06      	|  2.7691e-06     	|
|  [Callback]ModelSummary.on_epoch_end                                                                                                                                                                       	|  1.843e-06      	|  1              	|  1.843e-06      	|  2.6131e-06     	|
|  [Callback]ModelSummary.on_test_epoch_start                                                                                                                                                                	|  1.829e-06      	|  1              	|  1.829e-06      	|  2.5933e-06     	|
|  [Callback]TQDMProgressBar.on_test_epoch_end                                                                                                                                                               	|  1.768e-06      	|  1              	|  1.768e-06      	|  2.5068e-06     	|
|  [Callback]GradientAccumulationScheduler.on_configure_sharded_model                                                                                                                                        	|  1.764e-06      	|  1              	|  1.764e-06      	|  2.5011e-06     	|
|  [Callback]ModelSummary.on_test_end                                                                                                                                                                        	|  1.727e-06      	|  1              	|  1.727e-06      	|  2.4487e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                                                        	|  1.715e-06      	|  1              	|  1.715e-06      	|  2.4317e-06     	|
|  [Callback]ModelSummary.on_epoch_start                                                                                                                                                                     	|  1.661e-06      	|  1              	|  1.661e-06      	|  2.3551e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_test_end                        	|  1.596e-06      	|  1              	|  1.596e-06      	|  2.2629e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.teardown                           	|  1.573e-06      	|  1              	|  1.573e-06      	|  2.2303e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.on_before_accelerator_backend_setup	|  1.549e-06      	|  1              	|  1.549e-06      	|  2.1963e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_test_start                      	|  1.533e-06      	|  1              	|  1.533e-06      	|  2.1736e-06     	|
|  [Callback]TQDMProgressBar.on_before_accelerator_backend_setup                                                                                                                                             	|  1.49e-06       	|  1              	|  1.49e-06       	|  2.1126e-06     	|
|  [Callback]TQDMProgressBar.on_configure_sharded_model                                                                                                                                                      	|  1.481e-06      	|  1              	|  1.481e-06      	|  2.0999e-06     	|
|  [Callback]GradientAccumulationScheduler.on_before_accelerator_backend_setup                                                                                                                               	|  1.463e-06      	|  1              	|  1.463e-06      	|  2.0744e-06     	|
|  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                             	|  1.46e-06       	|  1              	|  1.46e-06       	|  2.0701e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_configure_sharded_model         	|  1.456e-06      	|  1              	|  1.456e-06      	|  2.0644e-06     	|
|  [Callback]GradientAccumulationScheduler.on_test_epoch_end                                                                                                                                                 	|  1.435e-06      	|  1              	|  1.435e-06      	|  2.0347e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_test_epoch_end                  	|  1.414e-06      	|  1              	|  1.414e-06      	|  2.0049e-06     	|
|  [LightningModule]CRNLightningModel.prepare_data                                                                                                                                                           	|  1.412e-06      	|  1              	|  1.412e-06      	|  2.002e-06      	|
|  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                          	|  1.398e-06      	|  1              	|  1.398e-06      	|  1.9822e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_end                       	|  1.391e-06      	|  1              	|  1.391e-06      	|  1.9723e-06     	|
|  [Callback]TQDMProgressBar.on_epoch_start                                                                                                                                                                  	|  1.382e-06      	|  1              	|  1.382e-06      	|  1.9595e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_start                     	|  1.361e-06      	|  1              	|  1.361e-06      	|  1.9297e-06     	|
|  [Callback]TQDMProgressBar.on_epoch_end                                                                                                                                                                    	|  1.332e-06      	|  1              	|  1.332e-06      	|  1.8886e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_test_epoch_start                	|  1.315e-06      	|  1              	|  1.315e-06      	|  1.8645e-06     	|
|  [LightningModule]CRNLightningModel.teardown                                                                                                                                                               	|  1.311e-06      	|  1              	|  1.311e-06      	|  1.8588e-06     	|
|  [Callback]TQDMProgressBar.on_test_epoch_start                                                                                                                                                             	|  1.298e-06      	|  1              	|  1.298e-06      	|  1.8404e-06     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_end                                                                                                                                                      	|  1.279e-06      	|  1              	|  1.279e-06      	|  1.8135e-06     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_start                                                                                                                                                    	|  1.273e-06      	|  1              	|  1.273e-06      	|  1.805e-06      	|
|  [Callback]GradientAccumulationScheduler.on_test_epoch_start                                                                                                                                               	|  1.272e-06      	|  1              	|  1.272e-06      	|  1.8035e-06     	|
|  [LightningModule]CRNLightningModel.on_test_start                                                                                                                                                          	|  8.7e-07        	|  1              	|  8.7e-07        	|  1.2335e-06     	|
|  [LightningModule]CRNLightningModel.on_test_end                                                                                                                                                            	|  8.31e-07       	|  1              	|  8.31e-07       	|  1.1783e-06     	|
|  [LightningModule]CRNLightningModel.on_test_epoch_start                                                                                                                                                    	|  7.83e-07       	|  1              	|  7.83e-07       	|  1.1102e-06     	|
|  [Strategy]DDPStrategy.on_test_start                                                                                                                                                                       	|  7.26e-07       	|  1              	|  7.26e-07       	|  1.0294e-06     	|
|  [LightningModule]CRNLightningModel.on_epoch_end                                                                                                                                                           	|  7.14e-07       	|  1              	|  7.14e-07       	|  1.0124e-06     	|
|  [Strategy]DDPStrategy.on_test_end                                                                                                                                                                         	|  7.01e-07       	|  1              	|  7.01e-07       	|  9.9393e-07     	|
|  [LightningModule]CRNLightningModel.on_epoch_start                                                                                                                                                         	|  6.89e-07       	|  1              	|  6.89e-07       	|  9.7692e-07     	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

